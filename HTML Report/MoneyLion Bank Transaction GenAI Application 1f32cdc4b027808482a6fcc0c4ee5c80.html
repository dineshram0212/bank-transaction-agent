<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Bank Transaction GenAI Application</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
  body {
    margin: 0;
    max-width: none;
    width: 100%;
    color: rgb(55, 53, 47);
    padding: 40px 20px 20px 20px; /* optional for spacing */
  }
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1f32cdc4-b027-8084-82a6-fcc0c4ee5c80" class="page sans"><header><h1 class="page-title">Bank Transaction GenAI Application</h1><p class="page-description"></p></header><div class="page-body"><hr id="1f32cdc4-b027-800a-ad2f-d09fb4f324e1"/><h1 id="1f32cdc4-b027-80ea-9b77-eabc05c3808f" class="">Overview</h1><p id="1f32cdc4-b027-80cd-9324-c0050bc259f1" class="">This project is an AI agent based banking assistant that is designed to let users interact with their transactional data through natural language. Built using <strong>Streamlit</strong>, <strong>OpenAI&#x27;s tool-calling API</strong>, and <strong>SQL-based querying</strong>, the assistant allows users to ask questions like <em>&quot;How much did I spend on groceries last month?&quot;</em> or <em>&quot;Show me a pie chart of my spending by category.&quot;</em></p><p id="1f32cdc4-b027-80b8-b191-fa153e18d1c5" class="">
</p><hr id="1f32cdc4-b027-80a4-8670-e3a3f2be2033"/><h1 id="1f32cdc4-b027-802b-b81d-e6f29682e068" class="">Architecture</h1><div id="1f32cdc4-b027-80f0-a12b-c6292bde4e03" class="column-list"><div id="1f32cdc4-b027-804b-836a-eb219c74e5fa" style="width:50%" class="column"><p id="1f32cdc4-b027-8001-84f5-e95aea947398" class="">The assistant is architected around a central <code>Agent</code> class that manages all interactions between the <strong>LLM</strong>, <strong>tools</strong>, and database and deployed in the <strong>Streamlit frontend</strong>. Below is an image of the core flow:</p><ol type="1" id="1f32cdc4-b027-80ff-9e90-cbd80ce71f4a" class="numbered-list" start="1"><li><strong>Streamlit, where </strong><code><strong>Agent()</strong></code><strong> is initialized, collects the user query  and passes it to </strong><code><strong>Agent.chat()</strong></code><strong> method along with:</strong><ol type="a" id="1f32cdc4-b027-8033-aaf2-fbdbedc1a775" class="numbered-list" start="1"><li>Client ID</li></ol><ol type="a" id="1f32cdc4-b027-80c0-b63d-fb054b3f94bf" class="numbered-list" start="2"><li>Current date</li></ol><ol type="a" id="1f32cdc4-b027-80c7-944b-c4104d21b2cf" class="numbered-list" start="3"><li>Selected model</li></ol><ol type="a" id="1f32cdc4-b027-80b3-ac9b-f24863df1e24" class="numbered-list" start="4"><li>Optional message history</li></ol></li></ol><ol type="1" id="1f32cdc4-b027-8081-8dac-e441c0a0bf8f" class="numbered-list" start="2"><li><strong>Agent builds context:</strong><ol type="a" id="1f32cdc4-b027-8005-b1c1-f68cb5f60039" class="numbered-list" start="1"><li>Using vector semantic search, top merchants and description keywords are fetched,<ul id="1f32cdc4-b027-80be-9023-c3c8a944c1f6" class="bulleted-list"><li style="list-style-type:disc"><code>VectorStore.get_unique_merchants_and_descriptions</code></li></ul></li></ol><ol type="a" id="1f32cdc4-b027-8032-aa36-fc8af687f66e" class="numbered-list" start="2"><li>Constructs a system prompt using these results, current date, and task instructions.</li></ol></li></ol><ol type="1" id="1f32cdc4-b027-8077-90dd-cb4c932e397e" class="numbered-list" start="3"><li><strong>Agent sends prompt and receives response:</strong><ol type="a" id="1f32cdc4-b027-8018-8ad6-e4359e84479f" class="numbered-list" start="1"><li>Initial state is set to <code>call_model</code> and <strong>prompt + message history is sent to the LLM</strong> using <code>OpenAI function calling</code> .</li></ol><ol type="a" id="1f32cdc4-b027-80b4-ba7a-f16c50ae50f2" class="numbered-list" start="2"><li>A response is sent back, either with a natural message or with a list of one or more <code>tool_calls</code> containing function name and arguments.</li></ol></li></ol><ol type="1" id="1f32cdc4-b027-80af-a7de-d60cfe867915" class="numbered-list" start="4"><li>Agent inspects the response using <code>should_continue()</code> :<ol type="a" id="1f32cdc4-b027-80c2-8b91-df463681e05a" class="numbered-list" start="1"><li>If <code>tool_calls</code> are present, <code>tool_node()</code> is called to execute them</li></ol><ol type="a" id="1f32cdc4-b027-806f-a8f9-fecf07089fca" class="numbered-list" start="2"><li>If a message is returned or an error occurs, it ends the loop</li></ol></li></ol><ol type="1" id="1f32cdc4-b027-8081-a9d2-e038aa271bda" class="numbered-list" start="5"><li><strong>In </strong><code><strong>tool_node()</strong></code>, the Agent:<ul id="1f32cdc4-b027-8096-8501-e8d7952b883d" class="bulleted-list"><li style="list-style-type:disc">Executes the requested tool (<code>query_sql</code>, <code>visualize_data</code>)</li></ul><ul id="1f32cdc4-b027-8025-a49d-f7b37f3d0cfd" class="bulleted-list"><li style="list-style-type:disc">Injects client-specific filters (like <code>client_id</code>)</li></ul><ul id="1f32cdc4-b027-800a-92c0-ceaaedaf1b50" class="bulleted-list"><li style="list-style-type:disc">Captures tool output as <code>last_result</code> or <code>chart</code>, depending on the tool</li></ul><ul id="1f32cdc4-b027-8050-9831-e682a85fe84e" class="bulleted-list"><li style="list-style-type:disc">Appends a summary (<code>&quot;Chart generated&quot;</code> or error message) back to message history</li></ul></li></ol><ol type="1" id="1f32cdc4-b027-80f8-b437-f5ad6f46d01a" class="numbered-list" start="6"><li><strong>Before returning to the UI</strong>:<ul id="1f32cdc4-b027-80fd-92f0-cba73ec4b0ad" class="bulleted-list"><li style="list-style-type:disc">Agent validates the <code>chart</code> object to ensure it&#x27;s a valid Plotly <code>Figure</code></li></ul><ul id="1f32cdc4-b027-809d-877c-d1bb744c926c" class="bulleted-list"><li style="list-style-type:disc">Resets <code>self.chart = None</code> to avoid carryover between interactions</li></ul></li></ol></div><div id="1f32cdc4-b027-80c8-a7a0-c4315a0a1c9c" style="width:50%" class="column"><figure id="1f32cdc4-b027-8047-adc1-f386c1327b68" class="image"><a href="bankagent.drawio.svg"><img style="width:1056px" src="bankagent.drawio.svg"/></a></figure><p id="1f32cdc4-b027-8007-a7d1-f78b3f520cd8" class="">
</p></div></div><ol type="1" id="1f32cdc4-b027-80b0-8724-ff26d6dce595" class="numbered-list" start="7"><li><strong>Streamlit receives the final message + chart</strong> and renders them</li></ol><p id="1f32cdc4-b027-80b2-b4f6-c11573ee68c1" class="">
</p><hr id="1f32cdc4-b027-8064-a456-de88e1d34f1c"/><h1 id="1f32cdc4-b027-80af-b7c3-fb7b596e4619" class="">Approach</h1><div id="1f32cdc4-b027-80e6-a848-c3979a5d8cf7" class="column-list"><div id="1f32cdc4-b027-804c-b7ca-e85943c41225" style="width:50%" class="column"><h3 id="1f32cdc4-b027-8056-a052-ec1c01df5248" class=""><span style="border-bottom:0.05em solid">Data Retrieval Strategy:</span></h3><p id="1f32cdc4-b027-80ca-adae-c2641f21959e" class="">A major portion of development time was spent planning an efficient and scalable way to retrieve relevant transaction data for a given user query.</p><ol type="1" id="1f32cdc4-b027-80f9-a819-e7c6a6c767ae" class="numbered-list" start="1"><li>Initial attempt:<p id="1f32cdc4-b027-8034-8c4d-e134418ad30d" class="">I started by loading the full dataset from a CSV into a Pandas DataFrame and performing filtering directly using string matches and vector similarity. While simple, this approach consumed high memory and either loss of more features or getting more noise due to manual top matches passing.</p></li></ol><ol type="1" id="1f32cdc4-b027-8046-8092-ccb99f9af94d" class="numbered-list" start="2"><li>Semantic Matching:<p id="1f32cdc4-b027-804f-96aa-f4fa83dbb8e6" class="">I experimented with combining <code>description</code> and <code>merchant</code> fields, then vectorizing them to retrieve semantically similar rows. While effective in identifying relevant matches, it sometimes excluded useful records due to cutoff thresholds or returned too many irrelevant rows.</p></li></ol><ol type="1" id="1f32cdc4-b027-8026-88d7-ceff3bd64d2c" class="numbered-list" start="3"><li>Metadata Filtering with ChromaDB:<p id="1f32cdc4-b027-8011-81bd-f2092bc47760" class="">For more precise retrieval, I added metadata - <code>client_id</code>, <code>category</code> . Using this in ChromaDB, I used the filter option along with the vector search. Even though it was effective, it required an additional LLM call to fetch the right <code>merchant</code> for filtering.</p></li></ol><ol type="1" id="1f32cdc4-b027-80ac-8127-c0ca06afc892" class="numbered-list" start="4"><li>Thresholding between Qdrant and ChromaDB:<p id="1f32cdc4-b027-80af-9244-c2409a737a2d" class="">Then I tried using Qdrant for built-in threshold feature but due to large number of tokens, it required a Qdrant server but I wanted to keep a simple database for the project and I used manual thresholding in ChromaDB. However, it wasn‚Äôt effective and faced loss of features like the second attempt.</p></li></ol><ol type="1" id="1f32cdc4-b027-8053-b4a7-f1d167e4d5fc" class="numbered-list" start="5"><li>Final Design Choice:<p id="1f32cdc4-b027-80ea-b912-ef02d55c7497" class="">Considering the need for vector search only on <code>desc</code>  and <code>merchant</code> for the LLM to know, I thought of extracting the unique merchants and description keywords related to the user query. So, before the user query is fed to the model, I passed it for vector search where I removed the stop words and then retrieved the list of unique <code>merchant</code> and <code>desc</code> keywords which will then be fed to the model in <code>system prompt</code> as available merchants and descriptions.</p></li></ol><h3 id="1f32cdc4-b027-80b5-8325-f9b5a0c7d9f5" class=""><span style="border-bottom:0.05em solid">LLM Agent Implementation</span></h3><p id="1f32cdc4-b027-8033-8b48-c9889e4b88f7" class="">Given the requirements to use <strong>native libraries, </strong>I implemented the agent using the <code>Open AI Python</code> library with <code>Groq</code> Client.</p><ol type="1" id="1f32cdc4-b027-80bb-a9a3-c9caf8fb50df" class="numbered-list" start="1"><li>Firstly, I built the <code>call_model()</code> method for passing the system prompt and user query to the model and get a response.</li></ol><ol type="1" id="1f32cdc4-b027-80f8-83e6-ec5f4ddebeb2" class="numbered-list" start="2"><li>Then I created a method, <code>tool_node()</code> , which looks out for <code>tool_calls</code> from the response and executed them by extracting the function name and arguments and running them. For charts, I assigned the output to class variable then pass it to the parent method.</li></ol><ol type="1" id="1f32cdc4-b027-807f-b419-d5ad037f0368" class="numbered-list" start="3"><li>To choose if the agent should continue and to decide where to route the response, I built <code>should_continue()</code> method which will decide if the state is <code>end</code> , <code>tool_call</code> , or <code>call_model</code>  based on the response.</li></ol><ol type="1" id="1f32cdc4-b027-80e0-9b44-ce26a421011b" class="numbered-list" start="4"><li>Finally, I put it altogether in the <code>chat()</code> method, which will decide which method to call based on the <code>state</code> and finally sends the response to the streamlit app.</li></ol><h3 id="1f32cdc4-b027-8006-b170-c8f3fad26837" class=""><span style="border-bottom:0.05em solid">Prompting Strategy</span></h3><p id="1f32cdc4-b027-8092-a395-d4f18552f2e3" class="">I used <strong>few-shot prompting</strong> with clear, structured instructions to guide the LLM&#x27;s tool calling behavior.</p><ol type="1" id="1f32cdc4-b027-8004-8bd0-d9875434cd0c" class="numbered-list" start="1"><li>I started with defining what‚Äôs the objective of the agent and with <code>IMPORTANT</code>instructions.</li></ol><ol type="1" id="1f32cdc4-b027-8093-ba8e-c1342c26526b" class="numbered-list" start="2"><li>Then, I added the <code>TABLE SCHEMA</code> and <code>TOOL DESCRIPTIONS</code> for the model to be aware of, mentioning the arguments they need to generate and the constraints they have.</li></ol><ol type="1" id="1f32cdc4-b027-804e-ba0d-ff9f20de5595" class="numbered-list" start="3"><li>Finally, I injected the <code><strong>merchants</strong></code><strong> </strong>and <code>descriptions</code> fetched from vector search and also added <code>today‚Äôs date</code> dynamically to help the model understand relative queries like ‚Äúlast week‚Äù or ‚Äúlast month.‚Äù</li></ol><h3 id="1f32cdc4-b027-80ce-85fe-e7cf9433a108" class=""><span style="border-bottom:0.05em solid">Tool Functions</span></h3><p id="1f32cdc4-b027-8004-940f-c2b4996f74c8" class="">There are two tool functions that I‚Äôve built:</p><ol type="1" id="1f32cdc4-b027-8051-9d22-d8eb1894c487" class="numbered-list" start="1"><li><code>query_sql</code> : It takes the arguments like date ranges, aggregations, conditions, etc., from the tool_call and builds a SQL query which will then be executed to get the transactions data.</li></ol><ol type="1" id="1f32cdc4-b027-80d4-8e31-db2da48b9219" class="numbered-list" start="2"><li><code>visualize_data</code> : It is built compatible for the output that <code>query_sql</code> produces, takes arguments like <code>chart_type</code>, <code>x</code>, <code>y</code>, <code>title</code> and creates a plotly figure.</li></ol><h3 id="1f32cdc4-b027-80c5-aecd-d9c2b471443e" class=""><span style="border-bottom:0.05em solid">UI Design</span></h3><p id="1f32cdc4-b027-8085-a87b-c6a4ac08e839" class="">The frontend was built using <strong>Streamlit</strong> with a minimal chat-style interface:</p><ol type="1" id="1f32cdc4-b027-80c0-9f24-f42fb495e72b" class="numbered-list" start="1"><li><strong>Main Window</strong>: Chat messages between the user and the assistant.</li></ol><ol type="1" id="1f32cdc4-b027-8011-a135-c4281a4fa70a" class="numbered-list" start="2"><li><strong>Sidebar</strong>:<ul id="1f32cdc4-b027-8009-83c4-c06f40eb651f" class="bulleted-list"><li style="list-style-type:disc">Simulated user settings (e.g., client ID selector)</li></ul><ul id="1f32cdc4-b027-80a4-aee9-f99832061729" class="bulleted-list"><li style="list-style-type:disc">Date picker to set a custom &quot;today&quot; date for queries</li></ul><ul id="1f32cdc4-b027-80f0-9d95-e4713f9d2156" class="bulleted-list"><li style="list-style-type:disc">Model selector to choose among tool-calling-capable models</li></ul></li></ol><p id="1f32cdc4-b027-8049-81a3-ea61c00a7529" class="">
</p></div><div id="1f32cdc4-b027-8033-a347-e129ad875a65" style="width:50%" class="column"><figure id="1f32cdc4-b027-8036-ad64-e38d4ce5b787" class="image"><a href="Screenshot_2025-05-14_111029.png"><img style="width:833.5px" src="Screenshot_2025-05-14_111029.png"/></a></figure><figure id="1f32cdc4-b027-801a-929b-dcaa296968e6" class="image"><a href="Screenshot_2025-05-14_111018.png"><img style="width:833.5px" src="Screenshot_2025-05-14_111018.png"/></a></figure><figure id="1f32cdc4-b027-80cb-bf7a-db9877bc0774" class="image"><a href="WhatsApp_Image_2025-05-13_at_20.54.52_74ee4923.jpg"><img style="width:576px" src="WhatsApp_Image_2025-05-13_at_20.54.52_74ee4923.jpg"/></a></figure><figure id="1f32cdc4-b027-809e-a327-f935610d8e44" class="image"><a href="Screenshot_2025-05-13_210921.png"><img style="width:288px" src="Screenshot_2025-05-13_210921.png"/></a></figure></div></div><hr id="1f32cdc4-b027-8050-af30-fab0d79f61f4"/><h1 id="1f32cdc4-b027-805f-9262-f29214da0523" class="">Challenges Faced and Solutions:</h1><h3 id="1f32cdc4-b027-8036-8ff0-cd51026186b5" class=""><strong>1. Data filtering logic:</strong></h3><p id="1f32cdc4-b027-80ec-a635-df267be30092" class=""><strong>Data filtering logic</strong> took the most time ‚Äî tried multiple approaches:</p><ul id="1f32cdc4-b027-8093-af74-c8bb72cece00" class="bulleted-list"><li style="list-style-type:disc">Started with CSV + DataFrame filtering</li></ul><ul id="1f32cdc4-b027-8012-9e86-c2d406309b1e" class="bulleted-list"><li style="list-style-type:disc">Used vector similarity on <code>desc + merchant</code> but lost useful data</li></ul><ul id="1f32cdc4-b027-802f-9a08-f45204f4097c" class="bulleted-list"><li style="list-style-type:disc">Added <code>client_id</code> and <code>category</code> filters to improve precision</li></ul><ul id="1f32cdc4-b027-8091-b849-c9450108d845" class="bulleted-list"><li style="list-style-type:disc">Finalized on extracting top merchants and keywords, letting LLM pick filters</li></ul><h3 id="1f32cdc4-b027-80ef-a1b0-ec72021612a1" class=""><strong>2. Switched to SQLite</strong> to reduce RAM usage from full CSV loads</h3><h3 id="1f32cdc4-b027-8016-9835-cd1f48c171cb" class="">3. <strong>Tool call sequencing</strong> was tricky:</h3><ul id="1f32cdc4-b027-8042-9597-cdcd3cf7d477" class="bulleted-list"><li style="list-style-type:disc">LLM sometimes tried to visualize before querying</li></ul><ul id="1f32cdc4-b027-8094-9a66-eaee58add2e3" class="bulleted-list"><li style="list-style-type:disc">Added a <code>should_continue()</code> method to choose correct order</li></ul><h3 id="1f32cdc4-b027-80cd-9a89-d581d26752a9" class=""><strong>4. Invalid tool call formatting</strong> from LLM (<code>&lt;tool_call&gt;</code>) caused errors:</h3><ul id="1f32cdc4-b027-8077-8b25-d480ac003b96" class="bulleted-list"><li style="list-style-type:disc">Handled by catching and returning a error message</li></ul><ul id="1f32cdc4-b027-8069-b1d6-cb3aca4f7958" class="bulleted-list"><li style="list-style-type:disc">Used only tool-calling supported models</li></ul><h3 id="1f32cdc4-b027-80ab-a641-e374141f6e7c" class="">5. Chart failures</h3><ul id="1f32cdc4-b027-803d-b402-cf70bff330fb" class="bulleted-list"><li style="list-style-type:disc">Prevented charts from being sent to LLM</li></ul><ul id="1f32cdc4-b027-80cc-98d9-e1654eca6164" class="bulleted-list"><li style="list-style-type:disc">Stored chart in <code>self.chart</code>, reset to <code>None</code> after returning</li></ul><ul id="1f32cdc4-b027-80a0-9b73-edf9b7e22669" class="bulleted-list"><li style="list-style-type:disc">Validated type before rendering avoiding trying to render error messages</li></ul><h3 id="1f32cdc4-b027-80e6-9d5b-c1ca86377ec3" class="">6. <strong>Extra tool args</strong></h3><ul id="1f32cdc4-b027-806b-bbf1-fdd02249dedd" class="bulleted-list"><li style="list-style-type:disc">LLM sometimes passed unnecessary arguments</li></ul><ul id="1f32cdc4-b027-8070-8fb6-c3dc1eed82f0" class="bulleted-list"><li style="list-style-type:disc">Filtered tool call params to only allow expected keys</li></ul><p id="1f32cdc4-b027-8078-ab6e-c790945062a5" class="">
</p><hr id="1f32cdc4-b027-80e2-8705-df0437886f85"/><h1 id="1f32cdc4-b027-80ad-a217-f6d557703a8e" class="">Getting Started</h1><h2 id="1f32cdc4-b027-807c-808e-d8c3c413ba48" class="">Project Structure</h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f32cdc4-b027-80f4-a8df-fb25990e0b72" class="code"><code class="language-Markdown">‚îú‚îÄ‚îÄ data/                # Includes the sqlite database and embeddings file
‚îú‚îÄ‚îÄ notebooks/           # Notebooks and their .html exports
‚îú‚îÄ‚îÄ main/                # Core application classes and app.py
‚îú‚îÄ‚îÄ report/              # Contains HTML report
‚îî‚îÄ‚îÄ requirements.txt     # All Python dependencies</code></pre><p id="1f32cdc4-b027-8005-80e0-cba31f6f7851" class="">
</p><h2 id="1f32cdc4-b027-8047-8126-c776a21643e6" class="">Create <code>.env</code> file</h2><p id="1f32cdc4-b027-80b7-87a9-c35adb265233" class="">In the root directory, create a <code>.env</code> file which houses the <code>LLM_API_KEY</code> </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f32cdc4-b027-8028-90d5-dcc585d004f3" class="code"><code class="language-Bash">LLM_API_KEY=&lt;your-groq-api-key&gt;</code></pre><p id="1f32cdc4-b027-8024-a864-c80c749c2cc0" class="">You can get your <strong>Groq API Key from: </strong><a href="https://console.groq.com/keys">https://console.groq.com/keys</a></p><h2 id="1f32cdc4-b027-8055-b5ae-fe05bab60e47" class="">Running the Application</h2><p id="1f32cdc4-b027-8086-9850-cb57488f8448" class="">In the root directory (where <code>requirements.txt</code> is located), run:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f32cdc4-b027-8023-a3d8-e2a99bb89813" class="code"><code class="language-Bash">pip install -r requirements.txt</code></pre><ul id="1f32cdc4-b027-80e1-83ff-fe9ef061c2ce" class="toggle"><li><details open=""><summary>We recommend using a virtual environment to avoid conflicts:</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f32cdc4-b027-8043-abea-ffac4ff13236" class="code"><code class="language-Bash">python -m venv venv
&gt; source venv/bin/activate  # or venv\Scripts\activate on Windows</code></pre></details></li></ul><p id="1f32cdc4-b027-801a-a3e9-d538352d989e" class="">
</p><p id="1f32cdc4-b027-8035-871e-eca5bbbcb9ce" class="">From the root directory:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f32cdc4-b027-802b-a575-da8077a6e0cd" class="code"><code class="language-Bash">cd main
streamlit run app.py</code></pre><p id="1f32cdc4-b027-8068-a203-e3e25fd908a6" class="">
</p><p id="1f32cdc4-b027-807a-838a-f4c732beeae6" class="">This will start the Streamlit app at:<br/>üëâ <br/><a href="http://localhost:8501/">http://localhost:8501</a></p><p id="1f32cdc4-b027-802b-a1ca-fb2de7a50577" class="">
</p><h3 id="1f32cdc4-b027-8041-beac-c403b582e516" class="">For embeddings file, <a href="https://drive.google.com/file/d/1f_YK3NHJZJLRL2YMzGidWT8XeUY0O8MJ/view?usp=sharing">https://drive.google.com/file/d/1f_YK3NHJZJLRL2YMzGidWT8XeUY0O8MJ/view?usp=sharing</a></h3><h2 id="1f32cdc4-b027-802a-b202-dacec8fbbf4a" class="">Example Prompts:</h2><ul id="1f32cdc4-b027-802a-bb0a-e31816126aec" class="bulleted-list"><li style="list-style-type:disc"><em>&quot;How much did I spend on Uber last month?&quot;</em></li></ul><ul id="1f32cdc4-b027-8085-b487-da986a60e6d6" class="bulleted-list"><li style="list-style-type:disc"><em>&quot;Visualise utility bills over the year.&quot;</em></li></ul><ul id="1f32cdc4-b027-8050-90b3-d630e70d5206" class="bulleted-list"><li style="list-style-type:disc"><em>&quot;Summarize my spending by category between August and September.&quot;</em></li></ul><p id="1f32cdc4-b027-8033-a39a-dbca8a5782ec" class="">
</p><blockquote id="1f32cdc4-b027-80b7-b2e3-f2195e0fddd8" class="">Since, <code>client_id</code> 880 and <code>dates</code> before <code>2024</code> have more data, consider using that in simuated settings.</blockquote><hr id="1f32cdc4-b027-80f1-a248-c761780cc11a"/><p id="1f32cdc4-b027-806b-8b79-e222f6c842f0" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>
